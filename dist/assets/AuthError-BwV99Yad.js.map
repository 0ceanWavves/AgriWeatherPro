{"version":3,"file":"AuthError-BwV99Yad.js","sources":["../../src/pages/Auth/AuthError.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { FaExclamationTriangle, FaEnvelope } from 'react-icons/fa';\r\n\r\nconst AuthError = () => {\r\n  const [errorType, setErrorType] = useState('');\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  \r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  \r\n  useEffect(() => {\r\n    // Parse error parameters from URL hash or query parameters\r\n    const parseErrorParams = () => {\r\n      // Check for hash fragment first (Supabase redirect format)\r\n      if (location.hash) {\r\n        const hashParams = new URLSearchParams(location.hash.substring(1));\r\n        const error = hashParams.get('error');\r\n        const errorCode = hashParams.get('error_code');\r\n        const errorDescription = hashParams.get('error_description');\r\n        \r\n        if (error) {\r\n          setErrorType(errorCode || error);\r\n          setErrorMessage(errorDescription || 'An authentication error occurred');\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Check query parameters as fallback\r\n      const queryParams = new URLSearchParams(location.search);\r\n      const error = queryParams.get('error');\r\n      const errorCode = queryParams.get('error_code');\r\n      const errorDescription = queryParams.get('error_description');\r\n      \r\n      if (error) {\r\n        setErrorType(errorCode || error);\r\n        setErrorMessage(errorDescription || 'An authentication error occurred');\r\n      } else {\r\n        // Default error if none specified\r\n        setErrorType('unknown');\r\n        setErrorMessage('An unknown authentication error occurred');\r\n      }\r\n    };\r\n    \r\n    parseErrorParams();\r\n  }, [location]);\r\n  \r\n  const handleResendVerification = async (e) => {\r\n    e.preventDefault();\r\n    if (!email) {\r\n      setErrorMessage('Please enter your email address');\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setSuccessMessage('');\r\n    \r\n    try {\r\n      const { error } = await supabase.auth.resend({\r\n        type: 'signup',\r\n        email,\r\n      });\r\n      \r\n      if (error) throw error;\r\n      \r\n      setSuccessMessage(`Verification email resent to ${email}. Please check your inbox and spam folder.`);\r\n    } catch (error) {\r\n      console.error('Error resending verification email:', error);\r\n      setErrorMessage(error.message || 'Failed to resend verification email');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const renderErrorContent = () => {\r\n    switch (errorType) {\r\n      case 'otp_expired':\r\n      case 'expired_otp':\r\n        return (\r\n          <div>\r\n            <p className=\"mb-4\">Your verification link has expired. Please enter your email below to request a new link.</p>\r\n            \r\n            <form onSubmit={handleResendVerification} className=\"mt-6\">\r\n              <div className=\"mb-4\">\r\n                <label htmlFor=\"email\" className=\"block text-sm font-medium mb-2\">Email Address</label>\r\n                <div className=\"relative\">\r\n                  <span className=\"absolute inset-y-0 left-0 flex items-center pl-3\">\r\n                    <FaEnvelope className=\"text-gray-400\" />\r\n                  </span>\r\n                  <input\r\n                    id=\"email\"\r\n                    type=\"email\"\r\n                    value={email}\r\n                    onChange={(e) => setEmail(e.target.value)}\r\n                    required\r\n                    className=\"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white\"\r\n                    placeholder=\"Enter your email\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              \r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                className=\"w-full bg-primary hover:bg-primary/90 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors disabled:opacity-50\"\r\n              >\r\n                {loading ? 'Sending...' : 'Resend Verification Link'}\r\n              </button>\r\n            </form>\r\n          </div>\r\n        );\r\n        \r\n      case 'access_denied':\r\n        return (\r\n          <div>\r\n            <p className=\"mb-4\">Access denied. You may not have permission to access this resource or your session has expired.</p>\r\n            <button\r\n              onClick={() => navigate('/signin')}\r\n              className=\"w-full bg-primary hover:bg-primary/90 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors mt-4\"\r\n            >\r\n              Go to Sign In\r\n            </button>\r\n          </div>\r\n        );\r\n        \r\n      case 'invalid_token':\r\n        return (\r\n          <div>\r\n            <p className=\"mb-4\">The authentication token is invalid or has expired.</p>\r\n            <button\r\n              onClick={() => navigate('/signin')}\r\n              className=\"w-full bg-primary hover:bg-primary/90 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors mt-4\"\r\n            >\r\n              Go to Sign In\r\n            </button>\r\n          </div>\r\n        );\r\n        \r\n      default:\r\n        return (\r\n          <div>\r\n            <p className=\"mb-4\">An authentication error occurred. Please try signing in again or contact support if the problem persists.</p>\r\n            <button\r\n              onClick={() => navigate('/signin')}\r\n              className=\"w-full bg-primary hover:bg-primary/90 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors mt-4\"\r\n            >\r\n              Go to Sign In\r\n            </button>\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-md w-full bg-white dark:bg-gray-800 shadow-md rounded-lg p-8\">\r\n        <div className=\"text-center mb-6\">\r\n          <div className=\"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-red-100 dark:bg-red-900\">\r\n            <FaExclamationTriangle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\r\n          </div>\r\n          <h2 className=\"mt-3 text-xl font-bold text-gray-900 dark:text-white\">Authentication Error</h2>\r\n          <p className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">{errorMessage}</p>\r\n        </div>\r\n        \r\n        {successMessage && (\r\n          <div className=\"mb-6 p-4 bg-green-100 dark:bg-green-900 rounded-lg text-green-800 dark:text-green-200\">\r\n            {successMessage}\r\n          </div>\r\n        )}\r\n        \r\n        {renderErrorContent()}\r\n        \r\n        <div className=\"mt-6 text-center\">\r\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n            <Link to=\"/signin\" className=\"text-primary hover:underline\">\r\n              Back to Sign In\r\n            </Link>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AuthError; "],"names":["AuthError","errorType","setErrorType","useState","errorMessage","setErrorMessage","email","setEmail","loading","setLoading","successMessage","setSuccessMessage","location","useLocation","navigate","useNavigate","useEffect","hashParams","error","errorCode","errorDescription","queryParams","handleResendVerification","e","supabase","renderErrorContent","jsx","jsxs","FaEnvelope","FaExclamationTriangle","Link"],"mappings":"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"}